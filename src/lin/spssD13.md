---
next: ./mode
---
# 相关与回归

<MyViews></MyViews> 

## 简介

::: tip 相关与回归的关系

---

相关就是用来反映两个连续变量具有线性关系(指两个变量符合一元一次方差的关系，而非多元或高次方差)强度的指标；对于积差相关来说，:warning:积差相关系数越大，表示线性关联越强，反之则表示线性关联越弱，此时可能是变量间没有关联，或是呈现非线性关系。

回归分析是以直线方程式来进行统计决策与应用，又称为线性回归(linear regression) 。:warning:一般来说，要先用相关系数去检验关联度，若显著相关，则说明线性关系是有意义的，这时便可进行回归分析。
:::

:::details 关于散点图
我们常使用散点图来直观地观察和估计两个变量的关系是否符合线性相关关系。下图为:man_student:散点图:woman_student:(或译散布图，scatter plot)示例：
<img   :src="$withBase('/spssPic/13/1.jpg')" alt="图片加载失败">
:::




## 基础知识

### 方差与协方差公式<badge type="warning" text="掌握" />
$$Variance(x)=\frac{\sum(X-\bar{X})^2}{N-1}=\frac{SS_x}{N-1}$$

$$Cov(X,Y)=\frac{\sum({X-\bar{X}})({Y-\bar{Y}})}{N-1}=\frac{SP_{xy}}{N-1}$$

### 皮尔逊（Pearson）积差相关公式<badge type="error" text="重要" />
$$r=\frac{\sum{cov(x,y)}}{s_xs_y}$$

:::tip 协方差与皮尔逊积差相关

+ 变量之间关系的一种粗略的度量就是协方差。

+ 如果我们标准化这个值，我们得到皮尔逊相关系数，r。

+ 相关系数必在- 1和+1之间。

+ 系数+1表示完全正相关，系数−1表示完全负相关，系数0表示完全没有线性关系。

  <img   :src="$withBase('/spssPic/13/3.jpg')" alt="图片加载失败">

:::

:::danger 前提假设

见[皮尔逊积差相关的假设检验公式](#皮尔逊积差相关的假设检验公式)

:::

:::warning 解读因果关系

1. 第三变量问题。在任何相关关系中，不能假定两个变量之间存在因果关系，因为可能存在其他已测量或未测量的变量影响结果。

2. 因果关系的方向。相关系数并不能说明是哪个变量引起的另一个改变，改变的”第一性“问题无法通过相关来确定。

:::

### 皮尔逊积差相关的假设检验公式<badge type="warning" text="应用" />
$$t=\frac{r-\rho_0}{S_r}=\frac{r-\rho_0}{\sqrt{\frac{1-r^2}{N-2}}}$$

::: details 关于皮尔逊积差相关的假设检验
上式中，分子为样本统计量的相关系数r与总体相关系数$\rho_0$的差距，分母为抽样标准误s,。 一般来说，研究者所关心的是样本相关是否显著不等于0,也就是说从样本得到的 r是否来自千相关为0 的总体，即$H_0:\rho_{xy}=.5$, 因此分子可写为r-0。 如果研究者想要了解从样本得到的r是否来自于某一相关（例如.5 )的总体，也可以利用以$H_0:\rho_{xy}=.5$ 的虚无假设检验来检验，此时分子为 r - . 5。

分子与分母两者相除后，得到 t 分数，配合 t 分布，即可进行统计显著性检验。 相关系数的 t 检验的自由度为N-2, 因为两个变量各取一个自由度进行样本方差估计。
:::

:::danger 前提假设

在仅使用皮尔逊积差相关时，我们只需要保证变量类型为等距变量或连续变量。

但在对相关系数进行假设检验时，我们需要保证两个变量的样本数据均呈正态分布。

:::



### 斯皮尔曼等级相关公式<badge type="warning" text="应用" />
$$r_s=1-\frac{6\sum{D_i^2}}{N(N^2-1)}$$

:::tip 关于斯皮尔曼相关

皮尔逊相关系数适用于两个连续变量的线性关联情形的描述，斯皮尔曼等级相关(Spearman rank order correlat ion coefficient,$\rho$; rs )应用于顺序变量线性关系的描述。这是一种[非参数检验方法](https://zhuanlan.zhihu.com/p/49472487),可以用来分析非正态分布的数据。斯皮尔曼的检验首先对数据进行排序，然后对这些排序应用皮尔森方程。

:::

:::details 一个例子

某工厂对工人的业务进行了一次考试，欲研究考试成绩与每月产量之间是否有联系，若随机抽选了一个样本，其考试成绩和产量数字如下表：

<img   :src="$withBase('/spssPic/13/2.jpg')" alt="图片加载失败">

　从表中的数字可以看出，工人的考试成绩愈高其产量也愈高，二者之间的联系程度是很一致的，但是皮尔逊相关系数r＝0.676 并不算太高，:warning:这是由于它们之间的关系并不是线性的，如果分别按考试成绩和产量高低变换成等级(见上表第3、4列)，则可以计算它们之间的斯皮尔曼等级相关系数为1。
:::

### 点二列相关公式<badge text="了解" />
$$r_{pb}=\frac{\bar{X_p}-{\bar{X_q}}}{S_t}\sqrt{pq}$$

:::tip 关于点二列相关

一为连续变晕，另一为二分类别变量（如性别）时， 两个变量的相关系数称为点二系列相关(point-biserial correlation)

:warning:从计算上说，皮尔逊与点二列相关的计算公式完全相同，结果也完全相同。

:::

### 肯德尔相关系数
Kendall的相关系数t与Spearman的$r_s$类似，但对于小样本可能更好。



### 偏相关<badge type="warning" text="应用" />

使用偏相关分析，我们可以找到当第三个变量的影响保持不变时，两个变量之间的关系。如考试成绩与焦虑程度和复习时间都有关，我们可以通过偏相关观察在排除了复习时间的影响后考试成绩与焦虑程度的影响。可以阅读[例题一](#例题一)。



### 半偏相关(semi-partial correlation)
:::details 详细信息
在偏相关中，当我们计算两个变量之间的部分相关性时，我们控制了第三个变量的影响。具体来说，第三个变量对这两个变量的影响是被控制的。而在半偏相关中，我们只控制第三个变量对相关中的一个变量产生的影响。

<img   :src="$withBase('/spssPic/13/12.jpg')" alt="图片加载失败">

总之：

+ 偏相关量化了两个变量之间的关系，同时控制了原始相关中第三个变量对两个变量的影响。
+ 半偏相关量化了两个变量之间的关系，同时控制了第三个变量的对其中一个变量的原始相关性的影响。
:::

### 决定系数公式<badge type="error" text="重要" />

$$R^2=r\times r$$

:::tip 关于决定系数
上式中r表示积差相关系数。
相关系数的平方(称为决定系数，$R^2$)是对一个变量与另一个变量共享的可变性量的测度。例如在后文的例题一中，考试成绩与焦虑程度的相关系数为-0.441，$R^2=0.194$。如果我们把这个值转换成一个百分比，我们可以说，考试焦虑在考试表现中占了19.4%的可变性。因此，尽管考试焦虑与考试成绩相关度比较高，但它只能解释考试成绩变化的19.4%。
:::



### 两个相关系数的差异是否显著？

:::details 独立的相关系数比较
在[例题一](#例题一) 的情境中，假设我们想验证男性中焦虑与考试成绩的相关性与女性中焦虑与考试成绩的相关性是否存在显著差异。

第一步：将$r_{male}和r_{female}$标准化

公式：$$z_r=\frac{1}{2}\log_e{\frac{1+r}{1-r}}$$

第二步：代入公式。

$$Z_{difference}=\frac{z_{r_{1}}-z_{r_{2}}}{\sqrt{\frac{1}{N_1-3}+\frac{1}{{N_2+3}}}}$$

计算可以获得，$Z_difference =-0.768$。根据Z值查找单尾情况下的正态分布表可知p=0.221>0.05，因此结论为差异不显著。
:::
:::details 非独立的相关系数比较
在[例题一](#例题一) 的情境中，假设我们想验证考试焦虑与考试成绩的关系是否强于复习与考试成绩的关系。直接带入公式：

$$t_{difference}=(r_{xy}-r_{zy})\sqrt{\frac{(n-3)(1+r_{xz})}{2(1-r_{xy}^2-r_{xz}^2-r_{zy}^2+2r_{xy}^2r_{xz}^2r_{zy}^2)}}$$

算得$t_{difference}=-5.09$，之后查找自由度为N-3的t分布表（N在本例中为100），双尾情况下，5.09>2.63，所以在0.01程度上显著。
:::
### 相关系数与效应量<badge text="心理学"/>

皮尔逊相关可以直接用作效应量。但当使用肯德尔和斯皮尔曼相关时，有以下两点不同：

1. 在使用斯皮尔曼相关作为效应量时，$r_s^2$应当被诠释为：它是两个变量在秩（ranks）中所占的方差比例。
2. 肯德尔的τ通常是比皮尔逊和斯皮尔曼相关系数小66-75%，因此它不能与其他两种相关系数比较，也不宜进行平方处理。

## SPSS操作

### 例题一

<a :href="$withBase('/spssData/Exam Anxiety.sav')" >:open_file_folder:Exam Anxiety.sav</a>

题目概述：一位心理学家对考试压力和复习对考试成绩的影响很感兴趣。她设计并验证了一份评估与考试相关的状态焦虑的问卷(称为考试焦虑问卷，简称EAQ)。该量表对焦虑进行了测量，满分为100分。考试前会测量学生的焦虑程度，然后用每个学生在考试中的分数来评估他们的考试表现。她还收集了学生花在复习上的时间。

1. 试探究焦虑与成绩的关系。
2. 请说明考试焦虑在控制变量的条件下对考试成绩的影响

:::details 方法提要

1. 皮尔逊积差相关
2. 偏相关

:::

:::details 题目1的解题思路

操作流程：`analysis`=>`correlate`=>`Bivariate`

<img   :src="$withBase('/spssPic/13/4.jpg')" alt="图片加载失败">

<img   :src="$withBase('/spssPic/13/5.jpg')" alt="图片加载失败">

您可以使用鼠标从列表中选择任何变量，并通过拖动它们到那里或单击。spss将为所有变量组合创建一个相关系数表。这个表称为相关矩阵。对于我们当前的例子，选择变量考试成绩，考试焦虑和复习时间，并通过点击将它们转移到变量框中。选择了感兴趣的变量之后，您可以在三个相关系数中进行选择:皮尔逊积矩相关系数、斯皮尔曼的rho和肯德尔的tau。

此外，还可以指定测试是单尾还是双尾。当有进行有方向性的测试时，应该选择单侧测试假设(例如：“一个人对考试越焦虑，他的分数就会越低”)。当您无法预测其性质时，应该使用双尾检验(默认值)（例如，“我不确定考试焦虑是否会提高或减少考试标志”)。因此，如果你有一个方向假设，那就点击单尾检验。

<img   :src="$withBase('/spssPic/13/6.jpg')" alt="图片加载失败">

只有选中皮尔逊相关时，`options`才是可用的。通过选中勾选框，结果中可以展示出一些计算的中间变量，包括均值、标准差、差积偏差和协方差。


<img   :src="$withBase('/spssPic/13/7.jpg')" alt="图片加载失败">

对于输出结果，从心理学的角度来说，随着对考试的焦虑程度的增加，考试成绩的百分比就会下降。相反，随着复习时间的增加，考试成绩的百分比也在增加。最后，随着复习时间的增加，学生对考试的焦虑会减少。所以这三个变量之间存在着复杂的相互关系。通过计算决定系数我们还可以得出，例如，尽管考试焦虑与考试成绩相关度比较高（-0.441），但它只能解释考试成绩变化的19.4%



最终结论：考试成绩与考试焦虑显著相关，r =−.44、复习花的时间r = .40;复习时间也与考试焦虑相关，r =−.71(所有p < .001)。

创造力与人们在世界上最大的说谎者竞赛中的表现显著相关。τ=.30, p < .001。

:::

:::details 题目1出现的设置项中缺失值设置项的说明

<img   :src="$withBase('/spssPic/13/6.jpg')" alt="图片加载失败">

当我们在浏览各种分析时，其中许多都有额外的选项，可以点击访问。通常情况下，结果选项对话框的一部分会问你，你是否想按对排除案例或按表排除案例。首先，我们可以按表排除案例，这意味着如果案例中任何变量的值缺失，那么它们将被从整个分析中排除。举个例子,如果我们的一个学生在我们的考试焦虑数据报告他们的焦虑,我们知道自己的考试成绩,但我们没有复习时间的数据,然后他们的数据不会被用来计算的相关性:他们将被完全排除在分析之外。

另一种选择是按对排除案例，这意味着如果一个参与者在某一特定变量或分析中没有得分，那么他们的数据只会被排除在涉及到他们没有得分的变量的计算中。对于我们没有复习数据的学生，这意味着在计算考试成绩与复习时间的相关性时，在计算考试焦虑与复习时间的相关性时，将排除他们的数据;然而，在计算考试焦虑和考试成绩之间的相关性时，学生的分数会被包括在内，因为对于这对变量，我们有他们的分数。
:::

:::details 题目2 的解题思路

操作流程：`analysis`=>`correlate`=>`Partial`

<img   :src="$withBase('/spssPic/13/10.jpg')" alt="图片加载失败">

<img   :src="$withBase('/spssPic/13/11.jpg')" alt="图片加载失败">

在`选项`中，我们勾选`零阶相关系数`来观察在未控制变量时的相关系数值。

从结论中我们可以看到，控制变量后的焦虑与考试成绩的相关度仅为-0.247，也就是说决定系数$R^2$取值约为0.06，即能够解释6%的成绩变化。而在不考虑复习时间影响的情况下，考试焦虑占考试成绩变化的19.4%。这说明考试焦虑本身确实解释了考试成绩的一些变化，但在焦虑、复习和考试表现之间存在着复杂的关系。

:::



### 例题二皮尔逊积差相关

[医咖会网站](https://www.mediecogroup.com/method_article_detail/42/)

### 例题三

<a :href="$withBase('/spssData/The Biggest Liar.sav')" >:open_file_folder:The Biggest Liar.sav</a>

题目概述：假设我想验证一个理论，即更有创造力的人将能够创造更好的故事并在故事比赛中取得更高的名次。数据第一列为创造力测量问卷，满分60，第二列是一个顺序变量，等级1的人排名比等级2的人高。忽略第三列变量。

小提示：在处理真实数据时，可以像这份数据一样，将position的度量标准设为顺序变量（ordinal），并给每个变量添加标签以对变量的意义进行说明。

:::details 方法提要

斯皮尔曼相关

:::

:::details 解题思路

本题的操作过程与例题一类似，应当选择Spearman' $\rho$和单尾检验。输出结果应如图：

<img   :src="$withBase('/spssPic/13/8.jpg')" alt="图片加载失败">

结论：创造力得分和一个人在世界上最大的说谎者竞赛中的表现之间存在着显著的关系。随着创造力的增加，位次的大小会下降。低的数字意味着你在比赛中做得很好，因此，我们的假设得到了支持:随着创造力的增加，比赛中的成功也随之增加。

最终结论：创造力与人们在这场世界上最大的说谎者竞赛中的表现显著相关。$r_s=.37$, p < .001。

:::



### 例题四斯皮尔曼相关

[医咖会网站](https://www.mediecogroup.com/method_article_detail/60/)

### 例题五

<a :href="$withBase('/spssData/pbcorr.sav')" >:open_file_folder:pbcorr.sav</a>

题目概述：使用点二列相关分析猫在外活动的时间和猫公母的关系。

:::details 方法提要

点二列相关

:::

:::details 解题思路

<img   :src="$withBase('/spssPic/13/9.jpg')" alt="图片加载失败">

由于点二列相关和皮尔逊相关的计算完全相同，因此这里直接使用皮尔逊相关进行分析。在这个例子中，$R^2=(0.378)^2 = .143$。因此,我们可以结论是，性别解释了离家时间变化的14.3%。

最终结论：猫的性别与离家时间显著相关，$r_{pb}$ = .38, p < .01。（注：$r_{pb}$表示点二列相关）

:::



:::details 拓展阅读：二列相关

当两变量都是正态连续变量，其中一个变量被人为地划分成二分变量时，适用二列相关。其数值不能用spss直接计算，可先计算点二列相关，再用下列公式进行转换。

$$r_b=\frac{r_{pb}\sqrt{pq}}{y}$$

下例是对二列相关结果的呈现：

A与B有显著相关，$r_b$= .48, p &lt;. 01。(注：$r_b$表示二列相关）

:::

### 例题六肯德尔相关
[医咖会网站](https://www.mediecogroup.com/method_article_detail/171/)





## 练习题

### 数据操作题

<a :href="$withBase('/spssData/Chamorro-Premuzic.sav')" >:open_file_folder:Chamorro-Premuzic.sav</a>

经验通常认为，外向的、活泼的课堂更受学生喜爱。但Tomas Chamorro-Premuzic提出另一个假设，即人格特点和自己相似的课堂更受学生喜欢。他用已有的NEO-FFI量表测了参与者的大五人格，又将测了学生对与大五人格特点相契合的老师的课堂的喜爱程度（例如，给定描述，热情,友好,热情,善于交际,开朗,充满深情的,外向的，要求他们从-5到~5打分，-5表示觉得这个要素不重要，+5表示非常想追随具有这样的特点的老师的课堂）。根据问卷结果，Chamorro-Premuzic制作了对五个特点的课堂的喜爱程度的测度。请对这些变量进行皮尔逊相关性分析，看看具有某些人格特征的学生是否希望他们的老师也具有这些人格特征。

:::details 点击查看答案

操作过程：<img   :src="$withBase('/spssPic/13/13.jpg')" alt="图片加载失败">

<img   :src="$withBase('/spssPic/13/14.jpg')" alt="图片加载失败">

观察并整理最终的表格。下面的表格是出现在论文中的：

<img   :src="$withBase('/spssPic/13/15.jpg')" alt="图片加载失败">

最终的结论为：

神经质的学生往往需要好相处（agreeable）的讲师，r= .10, p < .05;外向的学生倾向于需要外向的老师，r =. 15, p < .05;对经验开放的学生倾向于需要对经验开放的老师，r =.20, p < .01，不需要令人愉快的讲师，r =−.17, p < .01;好相处的学生需要各种各样的讲师，除了神经质和外向的之外。这可能是因为这些学生很随和!最后，认真负责的学生往往需要认真负责的老师，r = .22, p < .01，外向的老师，r = .10, p < .05，但不需要神经质的老师，r =−.14, p < .01。

:::


<MyValine/>





